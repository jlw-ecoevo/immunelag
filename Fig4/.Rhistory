}
return(out)
}
iterateOutbreakNoLag <- function(time_to_outbreak,parameters,state,frac_suscept_outbreak,n_iter=5,solver="lsoda"){
times <- seq(0, time_to_outbreak, by = 1)
out <- numeric()
for(i in 1:n_iter){
out_i <- ode(y = state,
times = times,
func = autoimmunitySystemNoLag,
parms = parameters,
method=solver)
out_i[,"time"] <- out_i[,"time"]+((i-1)*time_to_outbreak)
out <- rbind(out,out_i)
state <- getInitial(R=tail(out_i[,"R"],n=1),
U=(tail(out_i[,"D"],n=1)+tail(out_i[,"Id"],n=1)+tail(out_i[,"SM"],n=1))*frac_suscept_outbreak,
I=tail(out_i[,"I"],n=1),
Iv=tail(out_i[,"Iv"],n=1),
D=(1-frac_suscept_outbreak)*tail(out_i[,"D"],n=1),
Id=(1-frac_suscept_outbreak)*tail(out_i[,"Id"],n=1),
SM=(1-frac_suscept_outbreak)*tail(out_i[,"SM"],n=1),
V=tail(out_i[,"V"],n=1))
}
return(out)
}
iterateOutbreakInducible <- function(time_to_outbreak,parameters,state,frac_suscept_outbreak,n_iter=5,solver="lsoda"){
times <- seq(0, time_to_outbreak, by = 1)
out <- numeric()
for(i in 1:n_iter){
out_i <- ode(y = state,
times = times,
func = autoimmunitySystemInducible,
parms = parameters,
method=solver)
out_i[,"time"] <- out_i[,"time"]+((i-1)*time_to_outbreak)
out <- rbind(out,out_i)
state <- getInitialInducible(R=tail(out_i[,"R"],n=1),
U=(tail(out_i[,"D"],n=1)+tail(out_i[,"Id"],n=1)+tail(out_i[,"Df"],n=1)+tail(out_i[,"SM"],n=1))*frac_suscept_outbreak,
I=tail(out_i[,"I"],n=1),
Iv=tail(out_i[,"Iv"],n=1),
D=(1-frac_suscept_outbreak)*tail(out_i[,"D"],n=1),
Df=(1-frac_suscept_outbreak)*tail(out_i[,"Df"],n=1),
Id=(1-frac_suscept_outbreak)*tail(out_i[,"Id"],n=1),
SM=(1-frac_suscept_outbreak)*tail(out_i[,"SM"],n=1),
V=tail(out_i[,"V"],n=1))
}
return(out)
}
summaryIterate <- function(time_to_outbreak,frac_suscept_outbreak,parameters,state){
out <- iterateOutbreak(time_to_outbreak = time_to_outbreak,
parameters = parameters,
state = state,
frac_suscept_outbreak = frac_suscept_outbreak,
n_iter=10)
return(matrix(c(tail(out[,"D"],n=1)+tail(out[,"Id"],n=1),tail(out[,"SM"],n=1)),nrow=1))
}
summaryIterateNoLag <- function(time_to_outbreak,frac_suscept_outbreak,parameters,state){
out <- iterateOutbreakNoLag(time_to_outbreak = time_to_outbreak,
parameters = parameters,
state = state,
frac_suscept_outbreak = frac_suscept_outbreak,
n_iter=10)
return(matrix(c(tail(out[,"D"],n=1)+tail(out[,"Id"],n=1),tail(out[,"SM"],n=1)),nrow=1))
}
summaryIterateInducible <- function(time_to_outbreak,frac_suscept_outbreak,parameters,state){
out <- iterateOutbreakInducible(time_to_outbreak = time_to_outbreak,
parameters = parameters,
state = state,
frac_suscept_outbreak = frac_suscept_outbreak,
n_iter=10)
return(matrix(c(tail(out[,"D"],n=1)+tail(out[,"Id"],n=1)+tail(out[,"Df"],n=1),tail(out[,"SM"],n=1)),nrow=1))
}
parameters <- getParameters(v0=100,kappa=0.01,phi=0,zeta=1e-1)
state <- getInitialInducible(V=100)
out <- ode(y = state,
times = times,
func = autoimmunitySystem,
parms = parameters,
method="lsoda")
times <- seq(0, 72, by = 1)
out <- ode(y = state,
times = times,
func = autoimmunitySystemInducible(),
parms = parameters,
method="lsoda")
out <- ode(y = state,
times = times,
func = autoimmunitySystemInducible,
parms = parameters,
method="lsoda")
state <- getInitialInducible(V=100)
out <- ode(y = state,
times = times,
func = autoimmunitySystemInducible,
parms = parameters,
method="lsoda")
plotOut <- function(out,main=""){
par(mar=c(5.1, 5, 4.1, 1))
plot(out[,"time"],out[,"U"],type="l",
log="y",ylim=c(1,1e11),lwd=2,main=main,
xlab="Time (hours)",ylab="Density",
cex.axis=1.5,cex.lab=1.5,cex.main=2)
lines(out[,"time"],out[,"I"],col="black",lty=2,lwd=3)
lines(out[,"time"],out[,"D"],col=pal_npg("nrc")(6)[4],lwd=5)
lines(out[,"time"],out[,"Df"],col=pal_npg("nrc")(6)[2],lwd=5)
lines(out[,"time"],out[,"Id"],col=pal_npg("nrc")(6)[4],lty=2,lwd=3)
lines(out[,"time"],out[,"SM"],col=pal_npg("nrc")(6)[3],lwd=5)
lines(out[,"time"],out[,"V"],col=pal_npg("nrc")(6)[1],lwd=5)
par(mar=c(5.1, 4.1, 4.1, 2.1))
}
plotOut(out)
stat
state
iterateOutbreakInducible(24,parameters,state,0.5)
out <- iterateOutbreakInducible(24,parameters,state,0.5)
plotOut(out)
iterateOutbreak(24,parameters,state,0.5)
state <- getInitial(V=100)
iterateOutbreak(24,parameters,state,0.5)
out2 <- iterateOutbreak(24,parameters,state,0.5)
plotOut(out2)
out2["Df"] <- 0
out2[,"Df"] <- 0
out2 <- iterateOutbreak(24,parameters,state,0.5)
out2[,"Df"] <- 0
head(out2)
cbind(out2,numeric(nrow(out2))
)
out3 <- cbind(out2,numeric(nrow(out2)))
head(out3)
colnames(out3)
colnames(out3)[10] <- "Df"
colnames(out3)
plotOut(out3)
plotOut(out)
plot(out[,"time"],out["D"])
plot(out[,"time"],out[,"D"])
plot(out[,"time"],out[,"D"],type="l",log="y")
plot(out3[,"time"],out3[,"D"],type="l",log="y")
plot(out3[,"time"],out3[,"D"],type="l",log="y",xlim=c(1e1,1e9))
plot(out3[,"time"],out3[,"D"],type="l",log="y",xlim=c(1e1,1e12))
plot(out3[,"time"],out3[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out[,"time"],out[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out3[,"time"],out3[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out3[,"time"],out3[,"Df"],type="l",log="y",ylim=c(1e1,1e12))
plot(out3[,"time"],out3[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out[,"time"],out[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out[,"time"],out[,"Df"],type="l",log="y",ylim=c(1e1,1e12))
plot(out[,"time"],out[,"D"],type="l",log="y",ylim=c(1e1,1e12))
plot(out3[,"time"],out3[,"D"],type="l",log="y",ylim=c(1e1,1e12))
out3[,"D"]
out3[,"Id"]
plot(out3[,"time"],out3[,"D"]+out3[,"Id"],type="l",log="y",ylim=c(1e1,1e12))
plot(out[,"time"],out[,"D"]+out[,"Id"]+out[,"Df"],type="l",log="y",ylim=c(1e1,1e12))
plot(out3[,"time"],out3[,"D"]+out3[,"Id"],type="l",log="y",ylim=c(1e1,1e12),col="red")
lines(out[,"time"],out[,"D"]+out[,"Id"]+out[,"Df"],type="l",log="y",ylim=c(1e1,1e12),col="purple")
View(sim_inducible)
plot(sim_inducible$Var2,sim_grid_inducible$D)
plot(sim_inducible$Var2,sim_inducible$D)
plot(sim_inducible$Var2,sim_inducible$D,log="xy",type="l")
lines(sim_long$Var2,sim_long$D,log="xy",type="l")
plot(sim_inducible$Var2,sim_inducible$Sm,log="xy",type="l")
plot(sim_inducible$Var2,sim_inducible$SM,log="xy",type="l")
lines(sim_long$Var2,sim_long$SM,log="xy",type="l")
setwd("~/immunelag/Fig4")
load("outbreak_iterated.RData")
sim_long <- sim_grid_long %>% subset(Var1==24)
sim_short <- sim_grid_short %>% subset(Var1==24)
sim_none <- sim_grid_none %>% subset(Var1==24)
sim_inducible <- sim_grid_inducible %>% subset(Var1==24)
Xf <- sim_long$D
Yf <- sim_long$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_long <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_short$D
Yf <- sim_short$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_short <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_none$D
Yf <- sim_none$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_none <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_inducible$D
Yf <- sim_inducible$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_inducible <- (Xprop*0.5)/((1-Xprop)*0.5)
sim_long <- sim_grid_long %>% subset(Var1==24)
sim_short <- sim_grid_short %>% subset(Var1==24)
sim_none <- sim_grid_none %>% subset(Var1==24)
sim_inducible <- sim_grid_inducible_short %>% subset(Var1==24)
Xf <- sim_long$D
Yf <- sim_long$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_long <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_short$D
Yf <- sim_short$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_short <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_none$D
Yf <- sim_none$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_none <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_inducible$D
Yf <- sim_inducible$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_inducible <- (Xprop*0.5)/((1-Xprop)*0.5)
plot(sim_none$Var2,rel_fit_none,
type = "l",log="y",
xlab = "Fraction of Host Susceptible to Outbreak",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a",
ylim=c(1e-2,1e1),
xlim=c(0.001,0.8))
lines(sim_short$Var2,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_long$Var2,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var2,rel_fit_inducible,lwd=3,col="#984ea3")
text(0.75,3e0,"No Lag",col="#4daf4a")
text(0.13,1e-1,"Long Lag",col="#e41a1c")
text(0.7,1.4e0,"Upregulation",col="#984ea3")
text(0.62,1e-1,"Short Lag",col="#377eb8")
text(0.25,8.5e-1,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangefrac_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var2,rel_fit_none,
type = "l",log="y",
xlab = "Fraction of Host Susceptible to Outbreak",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a",
ylim=c(1e-2,1e1),
xlim=c(0.001,0.8))
lines(sim_short$Var2,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_long$Var2,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var2,rel_fit_inducible,lwd=3,col="#984ea3")
text(0.75,3e0,"No Lag",col="#4daf4a")
text(0.13,1e-1,"Long Lag",col="#e41a1c")
text(0.15,1e-1,"Upregulation",col="#984ea3")
text(0.62,1e-1,"Short Lag",col="#377eb8")
text(0.25,8.5e-1,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangefrac_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var2,rel_fit_none,
type = "l",log="y",
xlab = "Fraction of Host Susceptible to Outbreak",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a",
ylim=c(1e-2,1e1),
xlim=c(0.001,0.8))
lines(sim_short$Var2,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_long$Var2,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var2,rel_fit_inducible,lwd=3,col="#984ea3")
text(0.75,3e0,"No Lag",col="#4daf4a")
text(0.13,1e-1,"Long Lag",col="#e41a1c")
text(0.2,1e-1,"Upregulation",col="#984ea3")
text(0.62,1e-1,"Short Lag",col="#377eb8")
text(0.25,8.5e-1,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangefrac_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var2,rel_fit_none,
type = "l",log="y",
xlab = "Fraction of Host Susceptible to Outbreak",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a",
ylim=c(1e-2,1e1),
xlim=c(0.001,0.8))
lines(sim_short$Var2,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_long$Var2,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var2,rel_fit_inducible,lwd=3,col="#984ea3")
text(0.75,3e0,"No Lag",col="#4daf4a")
text(0.13,1e-1,"Long Lag",col="#e41a1c")
text(0.3,5e-2,"Upregulation",col="#984ea3")
text(0.62,1e-1,"Short Lag",col="#377eb8")
text(0.25,8.5e-1,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangefrac_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var2,rel_fit_none,
type = "l",log="y",
xlab = "Fraction of Host Susceptible to Outbreak",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a",
ylim=c(1e-2,1e1),
xlim=c(0.001,0.8))
lines(sim_short$Var2,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_long$Var2,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var2,rel_fit_inducible,lwd=3,col="#984ea3")
text(0.75,3e0,"No Lag",col="#4daf4a")
text(0.13,1e-2,"Long Lag",col="#e41a1c")
text(0.28,5e-2,"Upregulation",col="#984ea3")
text(0.62,1e-1,"Short Lag",col="#377eb8")
text(0.25,8.5e-1,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
sim_long <- sim_grid_long %>% subset(Var2==0.5)
sim_short <- sim_grid_short %>% subset(Var2==0.5)
sim_none <- sim_grid_none %>% subset(Var2==0.5)
sim_inducible <- sim_grid_inducible_short %>% subset(Var2==0.5)
Xf <- sim_long$D
Yf <- sim_long$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_long <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_short$D
Yf <- sim_short$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_short <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_none$D
Yf <- sim_none$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_none <- (Xprop*0.5)/((1-Xprop)*0.5)
Xf <- sim_inducible$D
Yf <- sim_inducible$SM
Xprop <- Xf/(Xf+Yf)
rel_fit_inducible <- (Xprop*0.5)/((1-Xprop)*0.5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(300,5,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(180,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(120,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(80,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(50,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(30,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(40,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(160,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(40,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(1e4,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(40,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(8e3,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(40,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(4e3,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
setwd("~/immunelag/Fig4")
pdf(paste0("outbreak_iterated_rangeinterval_shortinduction.pdf"),width=5,height=5)
plot(sim_none$Var1,rel_fit_none,
type = "l",log="xy",
ylim = c(1e-1,1e2),
xlab = "Time Between Outbreaks (hours)",
ylab = "Relative Fitness CRISPR x SM",lwd=3,
col="#4daf4a")
lines(sim_none$Var1,rel_fit_short,lwd=3,col="#377eb8")
lines(sim_none$Var1,rel_fit_long,lwd=3,col="#e41a1c")
lines(sim_inducible$Var1,rel_fit_inducible,lwd=3,col="#984ea3")
text(1.3e1,3,"No Lag",col="#4daf4a")
text(5e3,9e0,"Long Lag",col="#e41a1c")
text(40,1e-1,"Upregulation",col="#984ea3")
text(2,2.5e-1,"Short Lag",col="#377eb8")
text(5e3,1.2e0,"Rel. Fit. = 1",cex=0.6)
abline(h=1,lty=2)
dev.off()
